# Kubernetes ログ収集・参照仕様

## ログの収集方法
- kerutaシステムは、タスク実行Jobにより生成されたPodのログを自動的に収集します。
- 収集対象は標準出力（stdout）および標準エラー（stderr）です。
- ログはタスクIDと紐付けて保存されます。

## ログの構造
- タイムスタンプ
- ログレベル（INFO, WARN, ERROR等）
- タスクID
- Job名
- Pod名
- メッセージ本文

## ログの保存
- ログはkerutaのデータベースに保存されます。
- 保存期間は設定可能です（デフォルト: 30日）。
- 長期保存が必要なログは外部ストレージへエクスポート可能です。

## ログの参照
管理者はkerutaの管理パネルから、実行されたタスクのJobに紐づくPodログを直接確認できます。

1. **タスク一覧画面へアクセス**:
   - 管理パネルにログインし、ナビゲーションメニューから「タスク管理」を選択します。
2. **タスクの選択**:
   - ログを閲覧したいタスクを一覧から探し、対象タスクの「Logs」ボタンをクリックします。
3. **ログ閲覧**:
   - ログ閲覧用のモーダルウィンドウが開き、Jobに紐づくPodの標準出力および標準エラーが表示されます。
4. **ログの操作**:
   - **自動更新**: ログはリアルタイムでストリーミング表示されます。
   - **ダウンロード**: ログ全体をテキストファイルとしてダウンロードするボタンが提供されます。
   - **フィルタリング**: ログレベルやキーワードでログを絞り込む機能も利用できます。

また、APIエンドポイント `/api/tasks/{taskId}/log` を通じてもログデータを取得できます。

## ログレベル
- INFO: 通常の実行状況
- WARN: 警告（実行は継続可能）
- ERROR: エラー（実行継続不可）
- DEBUG: デバッグ情報（開発時のみ）

## ログローテーション
- ログサイズに基づくローテーション
- 時間に基づくローテーション
- 古いログの自動アーカイブ

## エラー通知
- ERRORレベルのログ発生時に管理者へ通知可能
- 通知方法は設定可能（Email, Slack等） 